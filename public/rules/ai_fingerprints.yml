- id: AI-FP-OPENAI-IMPORT
  title: "OpenAI SDK import detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+openai|from\\s+openai|require\\(['\"\\`]openai['\"\\`]\\)|import\\s+OpenAIApi|from\\s+['\"\\`]openai['\"\\`])"
  evidenceHint: "openai import"
  remediation: "Inventory and govern model usage. Ensure keys are secret-managed & usage policies enforced."
  confidence: 0.9
- id: AI-FP-ANTHROPIC-IMPORT
  title: "Anthropic SDK import detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+anthropic|from\\s+anthropic|require\\(['\"\\`]anthropic['\"\\`]\\)|from\\s+['\"\\`]anthropic['\"\\`])"
  evidenceHint: "anthropic import"
  remediation: "Track Anthropic usage and ensure API keys are secured."
  confidence: 0.8
- id: AI-FP-LANGCHAIN-IMPORT
  title: "LangChain library detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+langchain|from\\s+langchain|require\\(['\"\\`]langchain['\"\\`]\\)|from\\s+['\"\\`]langchain['\"\\`]|from\\s+langchain_openai|from\\s+langchain_anthropic|from\\s+langchain_google|import\\s+langchain_openai|import\\s+langchain_anthropic)"
  evidenceHint: "langchain import"
  remediation: "Document LangChain usage and ensure prompt handling policies."
  confidence: 0.75
- id: AI-FP-GPT-MODEL
  title: "GPT model reference detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(gpt-4|gpt-3\\.5|gpt-4o|gpt-4-turbo)"
  evidenceHint: "GPT model identifier"
  remediation: "Document which models are used and ensure usage policies are enforced."
  confidence: 0.6
- id: AI-FP-OPENAI-CLIENT
  title: "OpenAI client instantiation"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM06: Sensitive Information Disclosure"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(OpenAI\\(|openai\\.OpenAI|new\\s+OpenAI|ChatOpenAI\\(|from\\s+langchain_openai|from\\s+langchain\\.openai)"
  evidenceHint: "OpenAI client creation"
  remediation: "Ensure API keys are stored securely and not hardcoded."
  confidence: 0.8
- id: AI-FP-CHAT-COMPLETION
  title: "Chat completion API call detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM01: Prompt Injection"
    - "LLM09: Model Misuse"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(chat\\.completions\\.create|createChatCompletion)"
  evidenceHint: "Chat completion API usage"
  remediation: "Validate and sanitize user prompts to prevent injection attacks."
  confidence: 0.85
- id: AI-MCP-IMPORT
  title: "Model Context Protocol usage detected"
  severity: "moderate"
  category: "AI Tooling"
  owasp:
    - "LLM10: Supply Chain"
    - "LLM05: Excessive Agency"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(from\\s+anthropic\\.mcp|import\\s+(modelcontext|mcp_|@modelcontextprotocol)|McpServer\\s*\\(|class\\s+MCPTransport|class\\s+HTTPTransport|class\\s+SSETransport)"
  evidenceHint: "MCP client/server import or transport class"
  remediation: "Review MCP server exposure; restrict reachable tools and audit connector permissions."
  confidence: 0.65
- id: AI-MCP-CLIENT
  title: "MCP client instantiation"
  severity: "moderate"
  category: "AI Tooling"
  owasp:
    - "LLM10: Supply Chain"
    - "LLM05: Excessive Agency"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(McpClient\\s*\\(|new\\s+McpClient|createMcpClient|build_transport|HTTPTransport\\s*\\(|SSETransport\\s*\\()"
  evidenceHint: "MCP client or transport creation"
  remediation: "Validate MCP server endpoints and authenticate connections. Review which tools are exposed."
  confidence: 0.7
- id: AI-MCP-TOOLS
  title: "MCP tool registration or invocation"
  severity: "moderate"
  category: "AI Tooling"
  owasp:
    - "LLM05: Excessive Agency"
    - "LLM01: Prompt Injection"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(\"tools/list\"|\"tools/call\"|\"prompts/list\"|\"prompts/call\"|mcp_initialize|mcp_call|mcp_notify|try_list|listTools|callTool|registerTool|mcp\\.tools\\.|tools\\.call)"
  evidenceHint: "MCP tool/prompt method call or helper function"
  remediation: "Audit which tools are registered and validate inputs before tool execution."
  confidence: 0.7
- id: AI-MCP-PROTOCOL
  title: "MCP protocol version or session headers"
  severity: "low"
  category: "AI Tooling"
  owasp:
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(protocolVersion|Mcp-Session-Id|MCP-Session-Id|clientInfo.*MCP|OpenAI-MCP-Client)"
  evidenceHint: "MCP protocol version or session identifier"
  remediation: "Verify MCP protocol version compatibility and session management security."
  confidence: 0.6
- id: AI-FP-GOOGLE-GEMINI-IMPORT
  title: "Google Gemini SDK import detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+@google/generative-ai|from\\s+google\\.generativeai|require\\(['\"\\`]@google/generative-ai['\"\\`]\\)|import\\s+google\\.generativeai|from\\s+['\"\\`]google\\.generativeai['\"\\`])"
  evidenceHint: "Google Gemini import"
  remediation: "Track Gemini usage and ensure API keys are secured."
  confidence: 0.85
- id: AI-FP-AZURE-OPENAI-IMPORT
  title: "Azure OpenAI SDK import detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+@azure/openai|from\\s+azure\\.openai|require\\(['\"\\`]@azure/openai['\"\\`]\\)|import\\s+azure\\.openai|from\\s+['\"\\`]azure\\.openai['\"\\`]|from\\s+azure\\.ai\\.inference)"
  evidenceHint: "Azure OpenAI import"
  remediation: "Secure Azure OpenAI endpoints and API keys. Monitor usage and enforce policies."
  confidence: 0.85
- id: AI-FP-AWS-BEDROCK-IMPORT
  title: "AWS Bedrock SDK import detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+@aws-sdk/client-bedrock|from\\s+boto3.*import.*bedrock|require\\(['\"\\`]@aws-sdk/client-bedrock['\"\\`]\\)|from\\s+['\"\\`]@aws-sdk/client-bedrock-runtime['\"\\`]|from\\s+@aws-sdk/client-bedrock)"
  evidenceHint: "AWS Bedrock import"
  remediation: "Secure AWS credentials and IAM policies for Bedrock access. Monitor usage."
  confidence: 0.85
- id: AI-FP-MISTRAL-IMPORT
  title: "Mistral AI SDK import detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+@mistralai/mistralai|from\\s+mistralai|require\\(['\"\\`]@mistralai/mistralai['\"\\`]\\)|import\\s+mistralai|from\\s+['\"\\`]mistralai['\"\\`])"
  evidenceHint: "Mistral AI import"
  remediation: "Track Mistral usage and ensure API keys are secured."
  confidence: 0.8
- id: AI-FP-COHERE-IMPORT
  title: "Cohere SDK import detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+cohere-ai|from\\s+cohere(?:\\s|$)|require\\(['\"\\`]cohere-ai['\"\\`]\\)|import\\s+cohere(?:\\s|$)|from\\s+['\"\\`]cohere['\"\\`])"
  evidenceHint: "Cohere import"
  remediation: "Track Cohere usage and ensure API keys are secured."
  confidence: 0.8
- id: AI-FP-GROQ-IMPORT
  title: "Groq SDK import detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+groq-sdk|from\\s+groq(?:\\s|$)|require\\(['\"\\`]groq-sdk['\"\\`]\\)|import\\s+groq(?:\\s|$)|from\\s+['\"\\`]groq['\"\\`])"
  evidenceHint: "Groq import"
  remediation: "Track Groq usage and ensure API keys are secured."
  confidence: 0.8
- id: AI-FP-LM-STUDIO-IMPORT
  title: "LM Studio client detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(lm-studio|lm_studio|lmstudio|http://localhost:1234|http://127\\.0\\.0\\.1:1234|import\\s+lm_studio|from\\s+lm_studio)"
  evidenceHint: "LM Studio connection"
  remediation: "Ensure LM Studio is properly secured if exposed. Review local model usage policies."
  confidence: 0.75
- id: AI-FP-OLLAMA-IMPORT
  title: "Ollama client detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+ollama|from\\s+ollama|require\\(['\"\\`]ollama['\"\\`]\\)|Ollama\\(|http://localhost:11434|http://127\\.0\\.0\\.1:11434)"
  evidenceHint: "Ollama client or connection"
  remediation: "Secure Ollama endpoints and review which models are available locally."
  confidence: 0.75
- id: AI-FP-VLLM-IMPORT
  title: "vLLM runtime detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(import\\s+vllm|from\\s+vllm|LLMEngine|AsyncLLMEngine|vllm\\.LLM)"
  evidenceHint: "vLLM import or usage"
  remediation: "Review vLLM configuration and ensure models are properly secured."
  confidence: 0.75
- id: AI-FP-LLAMA-CPP-IMPORT
  title: "llama.cpp detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.cpp"
    - "**/*.c"
  contentRegex: "(llama_cpp|llama-cpp-python|from\\s+llama_cpp|import\\s+llama_cpp)"
  evidenceHint: "llama.cpp import or binding"
  remediation: "Review llama.cpp configuration and ensure local models are properly secured."
  confidence: 0.75
- id: AI-FP-LANGGRAPH-IMPORT
  title: "LangGraph library detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
    - "LLM05: Excessive Agency"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
  contentRegex: "(import\\s+langgraph|from\\s+langgraph|require\\(['\"\\`]langgraph['\"\\`]\\)|from\\s+@langchain/langgraph|from\\s+['\"\\`]langgraph['\"\\`])"
  evidenceHint: "LangGraph import"
  remediation: "Review LangGraph workflow definitions and ensure proper input validation and guardrails."
  confidence: 0.8
- id: AI-FP-AUTOGEN-IMPORT
  title: "AutoGen framework detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
    - "LLM05: Excessive Agency"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(import\\s+autogen|from\\s+autogen|require\\(['\"\\`]autogen['\"\\`]\\)|from\\s+pyautogen|import\\s+pyautogen)"
  evidenceHint: "AutoGen import"
  remediation: "Review AutoGen agent configurations and enforce proper access controls and tool restrictions."
  confidence: 0.75
- id: AI-FP-CREWAI-IMPORT
  title: "CrewAI framework detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
    - "LLM05: Excessive Agency"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(import\\s+crewai|from\\s+crewai|require\\(['\"\\`]crewai['\"\\`]\\)|from\\s+['\"\\`]crewai['\"\\`])"
  evidenceHint: "CrewAI import"
  remediation: "Review CrewAI crew and agent configurations. Ensure proper role definitions and tool access controls."
  confidence: 0.75
- id: AI-FP-SEMANTIC-KERNEL-IMPORT
  title: "Semantic Kernel framework detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
    - "LLM05: Excessive Agency"
  fileGlobs:
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.py"
    - "**/*.cs"
  contentRegex: "(import\\s+semantic-kernel|from\\s+semantic_kernel|require\\(['\"\\`]semantic-kernel['\"\\`]\\)|using\\s+Microsoft\\.SemanticKernel|from\\s+['\"\\`]semantic-kernel['\"\\`])"
  evidenceHint: "Semantic Kernel import"
  remediation: "Review Semantic Kernel plugins and planner configurations. Validate function inputs and outputs."
  confidence: 0.75
- id: AI-FP-LLAMAINDEX-IMPORT
  title: "LlamaIndex framework detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(import\\s+llama_index|from\\s+llama_index|require\\(['\"\\`]llama-index['\"\\`]\\)|from\\s+llama_index|import\\s+llamaindex|from\\s+llamaindex)"
  evidenceHint: "LlamaIndex import"
  remediation: "Review LlamaIndex query engines and data connectors. Ensure proper access controls on indexed data."
  confidence: 0.75
- id: AI-FP-DSPY-IMPORT
  title: "DSPy framework detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.py"
  contentRegex: "(import\\s+dspy|from\\s+dspy|from\\s+['\"\\`]dspy-ai['\"\\`])"
  evidenceHint: "DSPy import"
  remediation: "Review DSPy programs and modules. Ensure proper validation of optimized prompts and model calls."
  confidence: 0.75
- id: AI-FP-HAYSTACK-IMPORT
  title: "Haystack framework detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
  fileGlobs:
    - "**/*.py"
  contentRegex: "(import\\s+haystack|from\\s+haystack|from\\s+farm\\.haystack|from\\s+deepset\\.haystack)"
  evidenceHint: "Haystack import"
  remediation: "Review Haystack pipelines and document stores. Ensure proper access controls on indexed documents."
  confidence: 0.75
- id: AI-FP-LCEL-PATTERN
  title: "LangChain Expression Language (LCEL) pattern detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
    - "LLM10: Supply Chain"
    - "LLM05: Excessive Agency"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(RunnablePassthrough|RunnableSequence|RunnableLambda|RunnableParallel|chain\\s*=\\s*[a-zA-Z_][a-zA-Z0-9_]*\\s*\\||chain\\s*=\\s*[a-zA-Z_][a-zA-Z0-9_]*\\.pipe)"
  evidenceHint: "LCEL chain or pipeline pattern"
  remediation: "Review LCEL chain definitions and ensure proper input validation and error handling."
  confidence: 0.65
- id: AI-FP-CLAUDE-MODEL
  title: "Claude model reference detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(claude-3\\.5-sonnet|claude-3-opus|claude-3-sonnet|claude-3-haiku|claude-2|anthropic-claude)"
  evidenceHint: "Claude model identifier"
  remediation: "Document which Claude models are used and ensure usage policies are enforced."
  confidence: 0.6
- id: AI-FP-GEMINI-MODEL
  title: "Gemini model reference detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(gemini-1\\.5-pro|gemini-1\\.5-flash|gemini-pro|gemini-exp-|gemini-ultra|models/gemini)"
  evidenceHint: "Gemini model identifier"
  remediation: "Document which Gemini models are used and ensure usage policies are enforced."
  confidence: 0.6
- id: AI-FP-MISTRAL-MODEL
  title: "Mistral model reference detected"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(mistral-large-latest|mistral-medium|mistral-small|mixtral-8x7b|mixtral-8x22b)"
  evidenceHint: "Mistral model identifier"
  remediation: "Document which Mistral models are used and ensure usage policies are enforced."
  confidence: 0.6
- id: AI-FP-GPT-MODEL-EXPANDED
  title: "GPT model reference (expanded variants)"
  severity: "moderate"
  category: "AI Usage"
  owasp:
    - "LLM09: Model Misuse"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(gpt-4o|gpt-4-turbo|gpt-4\\.1|gpt-4o-mini|gpt-4-32k|gpt-3\\.5-turbo)"
  evidenceHint: "GPT model identifier (expanded)"
  remediation: "Document which GPT models are used and ensure usage policies are enforced."
  confidence: 0.6
- id: AI-FP-OPENAI-ENDPOINT
  title: "OpenAI API endpoint detected"
  severity: "high"
  category: "AI Usage"
  owasp:
    - "LLM01: Prompt Injection"
    - "LLM09: Model Misuse"
    - "LLM06: Sensitive Information Disclosure"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.go"
    - "**/*.rs"
  contentRegex: "(/v1/chat/completions|/v1/completions|/v1/models|api\\.openai\\.com/v1)"
  evidenceHint: "OpenAI API endpoint"
  remediation: "Ensure API keys are secured, validate all inputs, and monitor for prompt injection attempts."
  confidence: 0.85
- id: AI-FP-ANTHROPIC-ENDPOINT
  title: "Anthropic API endpoint detected"
  severity: "high"
  category: "AI Usage"
  owasp:
    - "LLM01: Prompt Injection"
    - "LLM09: Model Misuse"
    - "LLM06: Sensitive Information Disclosure"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.go"
    - "**/*.rs"
  contentRegex: "(/v1/messages|/v1/complete|api\\.anthropic\\.com/v1)"
  evidenceHint: "Anthropic API endpoint"
  remediation: "Ensure API keys are secured, validate all inputs, and monitor for prompt injection attempts."
  confidence: 0.85
- id: AI-FP-GOOGLE-ENDPOINT
  title: "Google AI API endpoint detected"
  severity: "high"
  category: "AI Usage"
  owasp:
    - "LLM01: Prompt Injection"
    - "LLM09: Model Misuse"
    - "LLM06: Sensitive Information Disclosure"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.go"
    - "**/*.rs"
  contentRegex: "(/v1beta/models|/v1/models|generativelanguage\\.googleapis\\.com)"
  evidenceHint: "Google AI API endpoint"
  remediation: "Ensure API keys are secured, validate all inputs, and monitor for prompt injection attempts."
  confidence: 0.85
- id: AI-FP-AWS-BEDROCK-ENDPOINT
  title: "AWS Bedrock endpoint detected"
  severity: "high"
  category: "AI Usage"
  owasp:
    - "LLM01: Prompt Injection"
    - "LLM09: Model Misuse"
    - "LLM06: Sensitive Information Disclosure"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
    - "**/*.go"
    - "**/*.rs"
  contentRegex: "(bedrock.*InvokeModel|bedrock.*InvokeModelWithResponseStream|bedrock-runtime\\.|bedrock\\.amazonaws\\.com)"
  evidenceHint: "AWS Bedrock endpoint or method"
  remediation: "Secure AWS credentials and IAM policies. Validate all inputs and monitor API usage."
  confidence: 0.85
- id: AI-FP-OPENAI-FUNCTION-CALLING
  title: "OpenAI function calling detected"
  severity: "high"
  category: "AI Usage"
  owasp:
    - "LLM01: Prompt Injection"
    - "LLM05: Excessive Agency"
    - "LLM09: Model Misuse"
  fileGlobs:
    - "**/*.py"
    - "**/*.ts"
    - "**/*.tsx"
    - "**/*.js"
    - "**/*.jsx"
  contentRegex: "(\"type\":\\s*\"function\"|functions\\s*=|tools\\s*=\\s*\\[|tool_choice|function_call)"
  evidenceHint: "OpenAI function calling configuration"
  remediation: "Review function definitions carefully. Validate function call outputs and implement proper sandboxing for tool execution."
  confidence: 0.8
